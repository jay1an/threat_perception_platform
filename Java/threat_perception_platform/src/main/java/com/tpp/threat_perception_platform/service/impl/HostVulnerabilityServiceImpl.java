package com.tpp.threat_perception_platform.service.impl;

import com.tpp.threat_perception_platform.mapper.HostVulnerabilityMapper;
import com.tpp.threat_perception_platform.pojo.HostVulnerability;
import com.tpp.threat_perception_platform.service.HostVulnerabilityService;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;
import org.springframework.transaction.annotation.Transactional;

import java.util.List;


@Service
public class HostVulnerabilityServiceImpl implements HostVulnerabilityService {

    @Autowired
    private HostVulnerabilityMapper hostVulnerabilityMapper;

    @Override
    @Transactional(rollbackFor = Exception.class)
    public void processHostVulnerabilities(List<HostVulnerability> hostVulnerabilities) {
        // 删除旧的
        String mac = hostVulnerabilities.get(0).getMac();
        hostVulnerabilityMapper.deleteByMac(mac);
        // 加入新的
        hostVulnerabilityMapper.insertBatch(hostVulnerabilities);
    }

    @Override
    public void deleteByMac(String mac) {
        hostVulnerabilityMapper.deleteByMac(mac);
    }


}
