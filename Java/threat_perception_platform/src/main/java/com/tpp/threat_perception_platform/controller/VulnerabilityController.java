package com.tpp.threat_perception_platform.controller;

import com.tpp.threat_perception_platform.annotation.MyLog;
import com.tpp.threat_perception_platform.param.MyParam;
import com.tpp.threat_perception_platform.pojo.Vulnerability;
import com.tpp.threat_perception_platform.response.ResponseResult;
import com.tpp.threat_perception_platform.service.VulnerabilityService;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.web.bind.annotation.*;

@RestController
@RequestMapping("/vulnerability")
public class VulnerabilityController {

    @Autowired
    private VulnerabilityService vulnerabilityService;

    @PostMapping("/list")
    @MyLog(title = "漏洞库模块", content = "查看漏洞数据")
    public ResponseResult<?> list(MyParam param) {
        return vulnerabilityService.list(param);
    }

    @PostMapping("/save")
    @MyLog(title = "漏洞库模块", content = "添加漏洞数据")
    public ResponseResult<?> save(@RequestBody Vulnerability vulnerability) {
        return vulnerabilityService.save(vulnerability);
    }

    @PostMapping("/delete")
    @MyLog(title = "漏洞库模块", content = "删除漏洞数据")
    public ResponseResult<?> delete(@RequestParam("ids[]")  Integer[] ids) {
        return vulnerabilityService.deleteByIds(ids);
    }

    @PostMapping("/edit")
    @MyLog(title = "漏洞库模块", content = "修改漏洞数据")
    public ResponseResult<?> edit(@RequestBody Vulnerability vulnerability) {
        return vulnerabilityService.edit(vulnerability);
    }

}
